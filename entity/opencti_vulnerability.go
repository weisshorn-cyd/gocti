// Code generated by '/tools/gocti_type_generator' for OpenCTI version 6.7.12 - DO NOT EDIT.

package entity

import (
	"fmt"
	"time"

	"github.com/weisshorn-cyd/gocti/graphql"

	_ "embed"
)

type Vulnerability struct {
	graphql.Vulnerability `gocti:",squash"`
}

//go:embed default_properties/vulnerability_default_properties.txt
var vulnerabilityDefaultProperties string

func (v Vulnerability) DefaultProperties() string {
	return vulnerabilityDefaultProperties
}

// Implementing the [api.ListableEntity] interface.

//go:embed list_queries/vulnerability_list_query.txt
var vulnerabilityListQueryString string

func (v Vulnerability) ListQueryString(customAttributes string) string {
	return fmt.Sprintf(
		vulnerabilityListQueryString,
		customAttributes,
	)
}

func (v Vulnerability) ListResponseField() string { return "vulnerabilities" }

// Implementing the [api.ReadableEntity] interface.

func (v Vulnerability) ReadQueryString(customAttributes string) string {
	return fmt.Sprintf(
		`query ($id: String) {
            vulnerability (id: $id) {%s}
        }`,
		customAttributes,
	)
}

func (v Vulnerability) ReadResponseField() string { return "vulnerability" }

// Implementing the [api.CreatableEntity] interface.

func (v Vulnerability) CreateQueryString(customAttributes string) string {
	return fmt.Sprintf(
		`mutation ($input: VulnerabilityAddInput!) {
            vulnerabilityAdd (input: $input) {%s}
        }`,
		customAttributes,
	)
}

func (v Vulnerability) CreateResponseField() string { return "vulnerabilityAdd" }

// VulnerabilityAddInput represents a GraphQL INPUT_OBJECT
// Some fields from the OpenCTI schema may be missing
// (See the examples for ways to expand an existing type).
type VulnerabilityAddInput struct {
	// VulnerabilityAddInput
	StixID                               string     `gocti:"stix_id"                                    json:"stix_id,omitempty"`
	XOpenctiStixIDs                      []string   `gocti:"x_opencti_stix_ids"                         json:"x_opencti_stix_ids,omitempty"`
	Name                                 string     `gocti:"name"                                       json:"name,omitempty"`
	Description                          string     `gocti:"description"                                json:"description,omitempty"`
	XOpenctiAliases                      []string   `gocti:"x_opencti_aliases"                          json:"x_opencti_aliases,omitempty"`
	XOpenctiCvssVectorString             string     `gocti:"x_opencti_cvss_vector_string"               json:"x_opencti_cvss_vector_string,omitempty"`
	XOpenctiCvssBaseScore                float64    `gocti:"x_opencti_cvss_base_score"                  json:"x_opencti_cvss_base_score,omitempty"`
	XOpenctiCvssBaseSeverity             string     `gocti:"x_opencti_cvss_base_severity"               json:"x_opencti_cvss_base_severity,omitempty"`
	XOpenctiCvssAttackVector             string     `gocti:"x_opencti_cvss_attack_vector"               json:"x_opencti_cvss_attack_vector,omitempty"`
	XOpenctiCvssAttackComplexity         string     `gocti:"x_opencti_cvss_attack_complexity"           json:"x_opencti_cvss_attack_complexity,omitempty"`
	XOpenctiCvssPrivilegesRequired       string     `gocti:"x_opencti_cvss_privileges_required"         json:"x_opencti_cvss_privileges_required,omitempty"`
	XOpenctiCvssUserInteraction          string     `gocti:"x_opencti_cvss_user_interaction"            json:"x_opencti_cvss_user_interaction,omitempty"`
	XOpenctiCvssScope                    string     `gocti:"x_opencti_cvss_scope"                       json:"x_opencti_cvss_scope,omitempty"`
	XOpenctiCvssConfidentialityImpact    string     `gocti:"x_opencti_cvss_confidentiality_impact"      json:"x_opencti_cvss_confidentiality_impact,omitempty"`
	XOpenctiCvssIntegrityImpact          string     `gocti:"x_opencti_cvss_integrity_impact"            json:"x_opencti_cvss_integrity_impact,omitempty"`
	XOpenctiCvssAvailabilityImpact       string     `gocti:"x_opencti_cvss_availability_impact"         json:"x_opencti_cvss_availability_impact,omitempty"`
	XOpenctiCvssExploitCodeMaturity      string     `gocti:"x_opencti_cvss_exploit_code_maturity"       json:"x_opencti_cvss_exploit_code_maturity,omitempty"`
	XOpenctiCvssRemediationLevel         string     `gocti:"x_opencti_cvss_remediation_level"           json:"x_opencti_cvss_remediation_level,omitempty"`
	XOpenctiCvssReportConfidence         string     `gocti:"x_opencti_cvss_report_confidence"           json:"x_opencti_cvss_report_confidence,omitempty"`
	XOpenctiCvssTemporalScore            float64    `gocti:"x_opencti_cvss_temporal_score"              json:"x_opencti_cvss_temporal_score,omitempty"`
	XOpenctiCvssV2VectorString           string     `gocti:"x_opencti_cvss_v2_vector_string"            json:"x_opencti_cvss_v2_vector_string,omitempty"`
	XOpenctiCvssV2BaseScore              float64    `gocti:"x_opencti_cvss_v2_base_score"               json:"x_opencti_cvss_v2_base_score,omitempty"`
	XOpenctiCvssV2AccessVector           string     `gocti:"x_opencti_cvss_v2_access_vector"            json:"x_opencti_cvss_v2_access_vector,omitempty"`
	XOpenctiCvssV2AccessComplexity       string     `gocti:"x_opencti_cvss_v2_access_complexity"        json:"x_opencti_cvss_v2_access_complexity,omitempty"`
	XOpenctiCvssV2Authentication         string     `gocti:"x_opencti_cvss_v2_authentication"           json:"x_opencti_cvss_v2_authentication,omitempty"`
	XOpenctiCvssV2ConfidentialityImpact  string     `gocti:"x_opencti_cvss_v2_confidentiality_impact"   json:"x_opencti_cvss_v2_confidentiality_impact,omitempty"`
	XOpenctiCvssV2IntegrityImpact        string     `gocti:"x_opencti_cvss_v2_integrity_impact"         json:"x_opencti_cvss_v2_integrity_impact,omitempty"`
	XOpenctiCvssV2AvailabilityImpact     string     `gocti:"x_opencti_cvss_v2_availability_impact"      json:"x_opencti_cvss_v2_availability_impact,omitempty"`
	XOpenctiCvssV2Exploitability         string     `gocti:"x_opencti_cvss_v2_exploitability"           json:"x_opencti_cvss_v2_exploitability,omitempty"`
	XOpenctiCvssV2RemediationLevel       string     `gocti:"x_opencti_cvss_v2_remediation_level"        json:"x_opencti_cvss_v2_remediation_level,omitempty"`
	XOpenctiCvssV2ReportConfidence       string     `gocti:"x_opencti_cvss_v2_report_confidence"        json:"x_opencti_cvss_v2_report_confidence,omitempty"`
	XOpenctiCvssV2TemporalScore          float64    `gocti:"x_opencti_cvss_v2_temporal_score"           json:"x_opencti_cvss_v2_temporal_score,omitempty"`
	XOpenctiCvssV4VectorString           string     `gocti:"x_opencti_cvss_v4_vector_string"            json:"x_opencti_cvss_v4_vector_string,omitempty"`
	XOpenctiCvssV4BaseScore              float64    `gocti:"x_opencti_cvss_v4_base_score"               json:"x_opencti_cvss_v4_base_score,omitempty"`
	XOpenctiCvssV4BaseSeverity           string     `gocti:"x_opencti_cvss_v4_base_severity"            json:"x_opencti_cvss_v4_base_severity,omitempty"`
	XOpenctiCvssV4AttackVector           string     `gocti:"x_opencti_cvss_v4_attack_vector"            json:"x_opencti_cvss_v4_attack_vector,omitempty"`
	XOpenctiCvssV4AttackComplexity       string     `gocti:"x_opencti_cvss_v4_attack_complexity"        json:"x_opencti_cvss_v4_attack_complexity,omitempty"`
	XOpenctiCvssV4AttackRequirements     string     `gocti:"x_opencti_cvss_v4_attack_requirements"      json:"x_opencti_cvss_v4_attack_requirements,omitempty"`
	XOpenctiCvssV4PrivilegesRequired     string     `gocti:"x_opencti_cvss_v4_privileges_required"      json:"x_opencti_cvss_v4_privileges_required,omitempty"`
	XOpenctiCvssV4UserInteraction        string     `gocti:"x_opencti_cvss_v4_user_interaction"         json:"x_opencti_cvss_v4_user_interaction,omitempty"`
	XOpenctiCvssV4ConfidentialityImpactV string     `gocti:"x_opencti_cvss_v4_confidentiality_impact_v" json:"x_opencti_cvss_v4_confidentiality_impact_v,omitempty"`
	XOpenctiCvssV4ConfidentialityImpactS string     `gocti:"x_opencti_cvss_v4_confidentiality_impact_s" json:"x_opencti_cvss_v4_confidentiality_impact_s,omitempty"`
	XOpenctiCvssV4IntegrityImpactV       string     `gocti:"x_opencti_cvss_v4_integrity_impact_v"       json:"x_opencti_cvss_v4_integrity_impact_v,omitempty"`
	XOpenctiCvssV4IntegrityImpactS       string     `gocti:"x_opencti_cvss_v4_integrity_impact_s"       json:"x_opencti_cvss_v4_integrity_impact_s,omitempty"`
	XOpenctiCvssV4AvailabilityImpactV    string     `gocti:"x_opencti_cvss_v4_availability_impact_v"    json:"x_opencti_cvss_v4_availability_impact_v,omitempty"`
	XOpenctiCvssV4AvailabilityImpactS    string     `gocti:"x_opencti_cvss_v4_availability_impact_s"    json:"x_opencti_cvss_v4_availability_impact_s,omitempty"`
	XOpenctiCvssV4ExploitMaturity        string     `gocti:"x_opencti_cvss_v4_exploit_maturity"         json:"x_opencti_cvss_v4_exploit_maturity,omitempty"`
	XOpenctiCwe                          []string   `gocti:"x_opencti_cwe"                              json:"x_opencti_cwe,omitempty"`
	XOpenctiCisaKev                      bool       `gocti:"x_opencti_cisa_kev"                         json:"x_opencti_cisa_kev,omitempty"`
	XOpenctiEpssScore                    float64    `gocti:"x_opencti_epss_score"                       json:"x_opencti_epss_score,omitempty"`
	XOpenctiEpssPercentile               float64    `gocti:"x_opencti_epss_percentile"                  json:"x_opencti_epss_percentile,omitempty"`
	XOpenctiScore                        int        `gocti:"x_opencti_score"                            json:"x_opencti_score,omitempty"`
	XOpenctiFirstSeenActive              *time.Time `gocti:"x_opencti_first_seen_active"                json:"x_opencti_first_seen_active,omitempty"`
	Confidence                           int        `gocti:"confidence"                                 json:"confidence,omitempty"`
	Revoked                              bool       `gocti:"revoked"                                    json:"revoked,omitempty"`
	Lang                                 string     `gocti:"lang"                                       json:"lang,omitempty"`
	CreatedBy                            string     `gocti:"createdBy"                                  json:"createdBy,omitempty"`
	ObjectMarking                        []string   `gocti:"objectMarking"                              json:"objectMarking,omitempty"`
	ObjectOrganization                   []string   `gocti:"objectOrganization"                         json:"objectOrganization,omitempty"`
	ObjectLabel                          []string   `gocti:"objectLabel"                                json:"objectLabel,omitempty"`
	ExternalReferences                   []string   `gocti:"externalReferences"                         json:"externalReferences,omitempty"`
	Created                              *time.Time `gocti:"created"                                    json:"created,omitempty"`
	Modified                             *time.Time `gocti:"modified"                                   json:"modified,omitempty"`
	XOpenctiWorkflowID                   string     `gocti:"x_opencti_workflow_id"                      json:"x_opencti_workflow_id,omitempty"`
	ClientMutationID                     string     `gocti:"clientMutationId"                           json:"clientMutationId,omitempty"`
	Update                               bool       `gocti:"update"                                     json:"update,omitempty"`
	File                                 []byte     `gocti:"file"                                       json:"file,omitempty"`
}

func (input VulnerabilityAddInput) Input() (map[string]any, error) {
	return map[string]any{
		"input": input,
	}, nil
}

// Implementing the [api.DeletableEntity] interface.

func (v Vulnerability) DeleteQueryString() string {
	return `mutation ($id: ID!) {
                vulnerabilityEdit (id: $id) {
                    delete
                }
            }`
}

func (v Vulnerability) DeleteResponseField() string { return "vulnerabilityEdit" }
