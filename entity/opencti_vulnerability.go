// Code generated by '/tools/gocti_type_generator' for OpenCTI version 6.5.8 - DO NOT EDIT.

package entity

import (
	"fmt"
	"time"

	"github.com/weisshorn-cyd/gocti/graphql"

	_ "embed"
)

type Vulnerability struct {
	graphql.Vulnerability `gocti:",squash"`
}

//go:embed default_properties/vulnerability_default_properties.txt
var vulnerabilityDefaultProperties string

func (v Vulnerability) DefaultProperties() string {
	return vulnerabilityDefaultProperties
}

// Implementing the [api.ListableEntity] interface.

//go:embed list_queries/vulnerability_list_query.txt
var vulnerabilityListQueryString string

func (v Vulnerability) ListQueryString(customAttributes string) string {
	return fmt.Sprintf(
		vulnerabilityListQueryString,
		customAttributes,
	)
}

func (v Vulnerability) ListResponseField() string { return "vulnerabilities" }

// Implementing the [api.ReadableEntity] interface.

func (v Vulnerability) ReadQueryString(customAttributes string) string {
	return fmt.Sprintf(
		`query ($id: String) {
            vulnerability (id: $id) {%s}
        }`,
		customAttributes,
	)
}

func (v Vulnerability) ReadResponseField() string { return "vulnerability" }

// Implementing the [api.CreatableEntity] interface.

func (v Vulnerability) CreateQueryString(customAttributes string) string {
	return fmt.Sprintf(
		`mutation ($input: VulnerabilityAddInput!) {
            vulnerabilityAdd (input: $input) {%s}
        }`,
		customAttributes,
	)
}

func (v Vulnerability) CreateResponseField() string { return "vulnerabilityAdd" }

// VulnerabilityAddInput represents a GraphQL INPUT_OBJECT
// Some fields from the OpenCTI schema may be missing
// (See the examples for ways to expand an existing type).
type VulnerabilityAddInput struct {
	// VulnerabilityAddInput
	StixID                            string     `gocti:"stix_id"                               json:"stix_id,omitempty"`
	XOpenctiStixIDs                   []string   `gocti:"x_opencti_stix_ids"                    json:"x_opencti_stix_ids,omitempty"`
	Name                              string     `gocti:"name"                                  json:"name,omitempty"`
	Description                       string     `gocti:"description"                           json:"description,omitempty"`
	XOpenctiAliases                   []string   `gocti:"x_opencti_aliases"                     json:"x_opencti_aliases,omitempty"`
	XOpenctiCvssBaseScore             float64    `gocti:"x_opencti_cvss_base_score"             json:"x_opencti_cvss_base_score,omitempty"`
	XOpenctiCvssBaseSeverity          string     `gocti:"x_opencti_cvss_base_severity"          json:"x_opencti_cvss_base_severity,omitempty"`
	XOpenctiCvssAttackVector          string     `gocti:"x_opencti_cvss_attack_vector"          json:"x_opencti_cvss_attack_vector,omitempty"`
	XOpenctiCvssIntegrityImpact       string     `gocti:"x_opencti_cvss_integrity_impact"       json:"x_opencti_cvss_integrity_impact,omitempty"`
	XOpenctiCvssAvailabilityImpact    string     `gocti:"x_opencti_cvss_availability_impact"    json:"x_opencti_cvss_availability_impact,omitempty"`
	XOpenctiCvssConfidentialityImpact string     `gocti:"x_opencti_cvss_confidentiality_impact" json:"x_opencti_cvss_confidentiality_impact,omitempty"`
	XOpenctiCisaKev                   bool       `gocti:"x_opencti_cisa_kev"                    json:"x_opencti_cisa_kev,omitempty"`
	XOpenctiEpssScore                 float64    `gocti:"x_opencti_epss_score"                  json:"x_opencti_epss_score,omitempty"`
	XOpenctiEpssPercentile            float64    `gocti:"x_opencti_epss_percentile"             json:"x_opencti_epss_percentile,omitempty"`
	Confidence                        int        `gocti:"confidence"                            json:"confidence,omitempty"`
	Revoked                           bool       `gocti:"revoked"                               json:"revoked,omitempty"`
	Lang                              string     `gocti:"lang"                                  json:"lang,omitempty"`
	CreatedBy                         string     `gocti:"createdBy"                             json:"createdBy,omitempty"`
	ObjectMarking                     []string   `gocti:"objectMarking"                         json:"objectMarking,omitempty"`
	ObjectOrganization                []string   `gocti:"objectOrganization"                    json:"objectOrganization,omitempty"`
	ObjectLabel                       []string   `gocti:"objectLabel"                           json:"objectLabel,omitempty"`
	ExternalReferences                []string   `gocti:"externalReferences"                    json:"externalReferences,omitempty"`
	Created                           *time.Time `gocti:"created"                               json:"created,omitempty"`
	Modified                          *time.Time `gocti:"modified"                              json:"modified,omitempty"`
	XOpenctiWorkflowID                string     `gocti:"x_opencti_workflow_id"                 json:"x_opencti_workflow_id,omitempty"`
	ClientMutationID                  string     `gocti:"clientMutationId"                      json:"clientMutationId,omitempty"`
	Update                            bool       `gocti:"update"                                json:"update,omitempty"`
	File                              []byte     `gocti:"file"                                  json:"file,omitempty"`
}

func (input VulnerabilityAddInput) Input() (map[string]any, error) {
	return map[string]any{
		"input": input,
	}, nil
}

// Implementing the [api.DeletableEntity] interface.

func (v Vulnerability) DeleteQueryString() string {
	return `mutation ($id: ID!) {
                vulnerabilityEdit (id: $id) {
                    delete
                }
            }`
}

func (v Vulnerability) DeleteResponseField() string { return "vulnerabilityEdit" }
